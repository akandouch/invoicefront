
<div class="form-group">
  <button *ngIf="invoice.status != 2" class="btn btn-outline-secondary" (click)="addItem(content)">
    <fa-icon [icon]="faPlus"></fa-icon>
    {{'common.action.add' | translate}}
  </button>
  <!--<div class="container-table-items col-lg-12" *ngIf="invoice.items.length > 0">
  <div class="row new-items table-header {{invoice.items.length>0?'':'hide'}}">
    <div class="col-lg-3">Project</div>
    <div class="col-lg-3">Period</div>
    <div class="col-lg-2">Nature</div>
    <div class="col-lg-1">Days</div>
    <div class="col-lg-1">Rate</div>
    <div class="col-lg-1">VAT%</div>
    <div class="col-lg-1"></div>
  </div>
  <div *ngFor="let i of invoice.items; let idx = index" class="row add-items table-items">
      <div class="col-lg-3">{{i.project}}</div>
      <div class="col-lg-3" *ngIf="i.period && i.period.from && i.period.to">
        {{i.period.from.day}}/{{i.period.from.month}}/{{i.period.from.year}} -
        {{i.period.to.day}}/{{i.period.to.month}}/{{i.period.to.year}}
      </div>
      <div class="col-lg-3 text-danger" *ngIf="!i.period || !i.period.from || !i.period.to">
        BUG WITH THE DATE. TODO FIX THAT!
      </div>
      <div class="col-lg-2">{{i.nature}}</div>
      <div class="col-lg-1">{{i.days}}</div>
      <div class="col-lg-1">{{i.rate}}</div>
      <div class="col-lg-1">{{i.vatRate}}</div>
      <div class="col-lg-1">
        <div ngbDropdown class="d-inline-block">
          <fa-icon [icon]="faEllipsisH" class="option-list-button" id="dropdown" ngbDropdownToggle></fa-icon>
          
          <div ngbDropdownMenu aria-labelledby="dropdown" class="dropdown-menu">
            <div (click)="editItem(contentEdit,i,idx)" *ngIf="invoice.status == 2"><fa-icon [icon]="faEye"></fa-icon> Consult</div> 
            <div (click)="editItem(contentEdit,i,idx)" *ngIf="invoice.status != 2"><fa-icon [icon]="faEdit"></fa-icon> Edit</div>
            <div (click)="copyItem(i)" *ngIf="invoice.status != 2"><fa-icon [icon]="faCopy"></fa-icon> Copy</div>
            <div (click)="removeItem(idx)" *ngIf="invoice.status != 2"><fa-icon [icon]="faTrashAlt"></fa-icon> Delete</div>
          </div>
        </div>       
      </div>
  </div>
  </div>-->
  <app-data-table 
  [dataSource]="invoice.items" 
  [dataColumns]="dataColumns"
  (consultEvent)="editItem(contentEdit, $event)"
  (editEvent)="editItem(contentEdit, $event)"
  (deleteEvent)="removeItem($event)"
  ></app-data-table>
</div>




<ng-template #content let-c="close" let-d="dismiss">
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Edit New</h4>
      <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body col-lg-12 row">
      <div class="col-lg-12">
        <label>Project</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="newItem.project"/>
      </div>
      <div class="col-lg-12">
        <label>Period</label>
        <app-calendar [period]="newItem.period"></app-calendar>
      </div>
      <div class="col-lg-12">
        <label>Natur</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="newItem.nature"/>
      </div>
      <div class="col-lg-4">
        <label># Days</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="newItem.days"/>
      </div>
      <div class="col-lg-4">
        <label>Rate</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="newItem.rate"/>
      </div>
      <div class="col-lg-4">
        <label>Vat Rate</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="newItem.vatRate"/>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="saveItem()">Save</button>
    </div>
</ng-template>
<ng-template #contentEdit let-c="close" let-d="dismiss" class="col-lg-12">
    <div class="modal-header col-lg-12">
      <h4 class="modal-title" id="modal-basic-title">Edit</h4>
      <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body col-lg-12 row">
      <div class="col-lg-12">
        <label>Project</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="currentItem.project" [readonly]="invoice.status == 2"/>
      </div>
      <div class="col-lg-12">
        <label>Period</label>
        <app-calendar [period]="currentItem.period" (dateSelected)="updateDays($event)"></app-calendar>
      </div>
      <div class="col-lg-12">
        <label>Natur</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="currentItem.nature" [readonly]="invoice.status == 2"/>
      </div>
      <div class="col-lg-4">
        <label># Days</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="currentItem.days" [readonly]="invoice.status == 2"/>
      </div>
      <div class="col-lg-4">
        <label>Rate</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="currentItem.rate"  [readonly]="invoice.status == 2"/>
      </div>
      <div class="col-lg-4">
        <label>Vat Rate</label>
        <input class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="currentItem.vatRate" [readonly]="invoice.status == 2"/>
      </div>
    </div>
    <div class="modal-footer col-lg-12">
      <button type="button" class="btn btn-outline-dark" (click)="updateItem()" *ngIf="invoice.status != 2">Update</button>
    </div>
</ng-template>
